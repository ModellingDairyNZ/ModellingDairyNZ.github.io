---
title: "README"
authors: "Pierre Beukes and Simon Woodward"
date: "12 April 2019"
permalink: /404.html
---

# Public Landing Page for MidellingDairyNZ 

Welcome to ModellingDairyNZ, the home of the Github repository for the Molly Cow model. The molly_cow_model repository is currently private and access may be obtained by contacting the collaborators. What follows is the README.md for the project. 

# Sharing Molly and MINDY C++ code

This is intended to be a living document that will be updated as we feel our way through this collaborative venture. The document will cover topics like our objectives, how the GitHub repo works, basic differences between the Molly versions, and voluntary agreements on code changes.

## Objectives

* Migrate from Molly AcslX with limited future to a translated Molly C++ that ensures more collaboration, easier use, programmer resources, and hopefully the future of the model.
* Create an open repository for the code and associated documentation that promotes wider use and improvement of the model and publication of peer reviewed papers.
* Capture all relevant improvements to the model for use in modelling studies that address dairy cow|system questions, and provide solutions that benefit dairy farmers.
* Share all improvements to Molly to a wider group of stakeholders, also for informal peer review.
* Collaborate with key stakeholders and control the integrity of a master Molly version, to form the basis for decisions on incorporating improvements.

## Repo procedures

### Storage and distribution
This is a private GitHub account containing the Master repo with all the code for running Molly_DNZ (DairyNZ), Molly_NA (North America), or MINDY versions on the R Studio IDE. The link and access to this repo will be distributed free of charge by DairyNZ (Pierre Beukes pierre.beukes@dairynz.co.nz or delegate) and Virginia Tech (Mark Hanigan mhanigan@vt.edu or delegate). These organizations will keep record of who has access to the repo. Downloading and use is subject to the licence agreement (see LICENCE.txt in this repo).

### Download procedure
* on the GitHub/ModellingDairyNZ website open the molly_cow_model repo
* on the righthand side there is a green drop-down button "Clone or download"
* open the drop-down and click "Download ZIP"
* copy the zip file from your download folder to where you want to save it
* unzip in the same folder or wherever you want
* open R Studio
* at the top right there is an R in a blue cube. This is a drop-down for opening R projects i.e. .Rproj files
* use the drop down then click "Open Project"
* go to the unzipped molly_cow_model folder on your computer
* note here. Don't select the high-level .Rproj which sits outside the version folders. This is the global project file
* click on the molly version you want to run until you are inside the folder
* inside that folder click the .Rproj file
* the folder of the version you are interested in is opened in R Studio
* in the files pane normally on the bottom right of your screen click the test_molly.r file
* the script will appear in the script pane
* at the top right of the script pane click "source" to run the selected molly version
* the console pane should show the running of the script and output plots should appear in the Plots pane

### Change procedure
* Any party with access to the Master repo can branch the repo, give the branched repo a new name and brief description, work with the code by cloning to whatever device, make improvements as they deem fit, test and document their changes, and save their changes (commit) to the branch.
* All parties with access to the Master will be able to see the new branch with changes made to the code and documentation.
* The party who created the branch and made the changes to the code, or any other party that considers the changes relevant for wider use, can submit a pull request, which will trigger a review procedure (oversight). The pull request is essentially a call to some overseeing body or people to review the changes and decide if it is fit for merger with the Master repo.
* Following is a set of instructions for fork-and-clone to your own GitHub account, make changes to the code, and make a pull request to merge changes in the master. From https://github.com/rstats-tln/fork-and-clone-repo
1. create a fork (click on the fork button top right) makes a copy for you to work on in your own private account
2. clone your private copy to your computer (click green clone button and copy SSH text). Create new project in RStudio “from version control”, enter the SSH line and set the directory you want to put it in.
3. Now you can edit the code
4. Commit and push your changes to Github
5. Create a pull request for changes you want merged in the master

### Oversight
* The NC-2040 group will deal with pull requests for mergers with Molly_NA Master, DairyNZ with pull requests for Molly_DNZ and MINDY. DairyNZ will communicate with Lincoln Uni (Pablo Gregorini) regarding pull requests for MINDY.
* When there is a pull request that affects the common part of Molly C++, which is the bulk of the code, then representatives from NC-2014, DairyNZ and Lincoln Uni can review and make the call for merging with Master, or not.

## Differences between versions
Some of these differences are documented in the journal papers that culminated from the work (see docs folder for a list of refs). Basic differences between Molly_DNZ and Molly_NA is that Molly_DNZ has been adapted and parameterized for a pasture eating New Zealand cow with a seasonal calving pattern. The intakes are predicted compared to Molly_NA where the largely TMR diet is eaten following user-defined daily intakes. Other differences are the lactation modules where Molly_DNZ can simulate once-a-day milking following mechanistic changes in mammary cell dynamics. The Molly_DNZ model is largely run as an animal model (dll wrapped as a com object) in a whole farm model representing a New Zealand dairy system. MINDY is a Molly version with extra modules attached and largely run as a standalone cow(s) for within-day simulations. The extras include modules for diurnal grazing patterns, feed preferences and diet selection, diurnal drinking and urination, and forage ingestion and oral processing (see refs by Gregorini et al in the docs folder).

## Voluntary agreements
* Clearly document all changes in the code.
* Do not change variable names without a VERY good reason. (see docs folder for variable names|abbreviations and definitions. At the time of writing 14 Dec 2018, these lists have not been checked for accuracy).
* Test changes in the code with observed|trial|meta data and provide the data (if possible) and the R script with test stats output. There is an idea to develop a standard R script for loading test data and giving standard test statistics for comparing old versus new versions.
* If the changes are deemed substantial enough, document it as a peer reviewed publication.

